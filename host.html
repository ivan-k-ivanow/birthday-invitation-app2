<!DOCTYPE html>
<html lang="bg">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Guest List - –¶–≤–µ—Ç–∞–ª–∏–Ω–∞ 50</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="./styles/host.css">
</head>

<body>
    <div class="container">
        <h1>–°–ø–∏—Å—ä–∫ —Å –≥–æ—Å—Ç–∏ üéâ</h1>
        <div id="login-container">
            <p>–ú–æ–ª—è, –≤—ä–≤–µ–¥–µ—Ç–µ –ø–∞—Ä–æ–ª–∞—Ç–∞, –∑–∞ –¥–∞ –≤–∏–¥–∏—Ç–µ —Å–ø–∏—Å—ä–∫–∞ —Å –≥–æ—Å—Ç–∏:</p>
            <input type="password" id="password-input" placeholder="–ü–∞—Ä–æ–ª–∞">
            <button id="login-btn">–í—Ö–æ–¥</button>
            <p id="login-error" class="error"></p>
        </div>

        <div id="guest-container" class="hidden">
            <ul id="guest-list"></ul>
        </div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
        import { getFirestore, collection, getDocs } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyDVVWOffDh2IIzWEmXiPLvaydTLGmWI1Xs",
            authDomain: "cvetalina-birthday.firebaseapp.com",
            projectId: "cvetalina-birthday",
            storageBucket: "cvetalina-birthday.firebasestorage.app",
            messagingSenderId: "101869059890",
            appId: "1:101869059890:web:44e0d0ae4b878ffd8c612b"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const guestsCol = collection(db, "guests");

        const HOST_PASSWORD = "!cvetalina50"; // Change to a secure password
        const loginBtn = document.querySelector("#login-btn");
        const passwordInput = document.querySelector("#password-input");
        const loginError = document.querySelector("#login-error");
        const loginContainer = document.querySelector("#login-container");
        const guestContainer = document.querySelector("#guest-container");
        const guestListEl = document.querySelector("#guest-list");

        loginBtn.addEventListener("click", async () => {
            const password = passwordInput.value.trim();
            if (password !== HOST_PASSWORD) {
                loginError.textContent = "–ù–µ–≤–∞–ª–∏–¥–Ω–∞ –ø–∞—Ä–æ–ª–∞. –û–ø–∏—Ç–∞–π—Ç–µ –ø–∞–∫!";
                return;
            }

            // Hide login, show guest list
            loginContainer.classList.add("hidden");
            guestContainer.classList.remove("hidden");

            // Fetch guest list
            const snapshot = await getDocs(guestsCol);
            guestListEl.innerHTML = ""; // clear any previous
            snapshot.forEach(doc => {
                const guest = doc.data();
                const li = document.createElement("li");
                li.textContent = `${guest.name} - ${guest.attendance === "yes" ? "–©–µ –ø—Ä–∏—Å—ä—Å—Ç–≤–∞" : "–ù—è–º–∞ –¥–∞ –ø—Ä–∏—Å—ä—Å—Ç–≤–∞"}`;
                guestListEl.appendChild(li);
            });
        });
    </script>
</body>

</html>
